<%#= render( partial: "jobs/filter", locals: { jobs: @filtered_jobs } ) %>

<%= form_for_filterrific @filterrific do |f| %>
  <div class="col-md-12">
    <div class="search">
      <%# give the search field the 'filterrific-periodically-observed' class for live updates %>
      <%= f.text_field(:search_query, class: 'filterrific-periodically-observed search-bar') %>
    </div>
    <h1>We found <%= @filterrific.find.size %> jobs</h1>
  </div>
  <div class="col-md-4">
    <p>Filter by:</p>
    <div>
      <%= link_to('Reset filters', reset_filterrific_url) %>
    </div>
    <div>
      Job Posted After
      <%= f.text_field(:with_posted_at_gte, class: 'js-datepicker') %>
    </div>
    <div class="panel-group max-width" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-default">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          <div class="panel-heading" role="tab" id="headingOne">
            <h4 class="panel-title">
              Industry
            </h4>
          </div>
        </a>
      </div>
      <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
        <div class="panel-body">
          <%#= f.select(:with_industry_id, @filterrific.select_options[:with_industry_id], { include_blank: '- Any -' }) %>
          <%= f.collection_check_boxes(:with_industry_id, Industry.all, :id, :name) do |b| %>
          <div class="block">
            <div class="inline">
              <%= b.check_box %>
              <%= b.object.name %>
              (<%= @filtered_jobs.where(industry_id: b.object.id).size %>)
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>

    <div class="panel-group max-width" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-default">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
          <div class="panel-heading" role="tab" id="headingTwo">
            <h4 class="panel-title">
              Category
            </h4>
          </div>
        </a>
      </div>
      <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
        <div class="panel-body">
          <%= f.collection_check_boxes(:with_category_id, Category.all, :id, :name) do |b| %>
          <div class="block">
            <div class="inline">
              <%= b.check_box %>
              <%= b.object.name %>
              (<%= @filtered_jobs.where(category_id: b.object.id).size %>)
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="panel-group max-width" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-default">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
          <div class="panel-heading" role="tab" id="headingThree">
            <h4 class="panel-title">
              Contract Type
            </h4>
          </div>
        </a>
      </div>
      <div id="collapseThree" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingThree">
        <div class="panel-body">
          <%= f.collection_check_boxes(:with_contract_type_id, ContractType.all, :id, :name) do |b| %>
          <div class="block">
            <div class="inline">
              <%= b.check_box %>
              <%= b.object.name %>
              (<%= @filtered_jobs.where(contract_type_id: b.object.id).size %>)
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="panel-group max-width" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-default">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
          <div class="panel-heading" role="tab" id="headingFour">
            <h4 class="panel-title">
              Job Location
            </h4>
          </div>
        </a>
      </div>
      <div id="collapseFour" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFour">
        <div class="panel-body">
          <%= f.collection_check_boxes(:with_location_id, Location.all, :id, :name) do |b| %>
          <div class="block">
            <div class="inline">
              <%= b.check_box %>
              <%= b.object.name %>
              (<%= @filtered_jobs.where(location_id: b.object.id).size %>)
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="panel-group max-width" id="accordion" role="tablist" aria-multiselectable="true">
      <div class="panel panel-default">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
          <div class="panel-heading" role="tab" id="headingFive">
            <h4 class="panel-title">
              Salary Range
            </h4>
          </div>
        </a>
      </div>
      <div id="collapseFive" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingFive">
        <div class="panel-body">
          <%= f.collection_check_boxes(:with_salary_range_id, SalaryRange.all, :id, :range) do |b| %>
          <div class="block">
            <div class="inline">
              <%= b.check_box %>
              <%= b.object.range %>
              (<%= @filtered_jobs.where(salary_range_id: b.object.id).size %>)
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div>
    Sorted by
    <%= f.select(:sorted_by, @filterrific.select_options[:sorted_by]) %>
  </div>
  <%= render_filterrific_spinner %>
<% end %>
